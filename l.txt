[
    {
        id 28cb5adefa62617e,
        type tab,
        label üåø–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –≥–∞–∑–æ–Ω–∞,
        disabled false,
        info ,
        env []
    },
    {
        id 97747586d5abeb96,
        type inject,
        z 28cb5adefa62617e,
        name –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 600,
        props [
            {
                p payload
            }
        ],
        repeat ,
        crontab 00 06   ,
        once false,
        onceDelay ,
        topic ,
        payload ,
        payloadType str,
        x 200,
        y 100,
        wires [
            [
                c1a5a918e5831042,
                2a83d16c0e4e12fd,
                9bec688d2806ee9d,
                261bdeb51194f0b6,
                634374e67d313901,
                3a57fd6cbf8a8fae,
                7d8f824952c4578d,
                f3e331678d548323,
                8f54806c78f9f21b,
                920395437ecb30fb
            ]
        ]
    },
    {
        id 261bdeb51194f0b6,
        type http request,
        z 28cb5adefa62617e,
        name OpenMeteo –ü—Ä–æ–≥–Ω–æ–∑,
        method GET,
        ret txt,
        url httpsapi.open-meteo.comv1forecastlatitude=55.934&longitude=36.61&daily=precipitation_sum,et0_fao_evapotranspiration,temperature_2m_min,temperature_2m_max&timezone=auto,
        x 200,
        y 200,
        wires [
            [
                b4a5622350476f22
            ]
        ]
    },
    {
        id b4a5622350476f22,
        type function,
        z 28cb5adefa62617e,
        name –ü–∞—Ä—Å–∏–Ω–≥ OpenMeteo,
        func try {n  const data = JSON.parse(msg.payload);n  const todayIndex = 0;n  const tomorrowIndex = 1;n  msg.openmeteo = {n     –î–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ–≥–æ–¥–Ω—èn    rain_today data.daily.precipitation_sum[todayIndex]  0,n    et0_today data.daily.et0_fao_evapotranspiration[todayIndex]  0,n    temp_min_today data.daily.temperature_2m_min[todayIndex]  0,n    temp_max_today data.daily.temperature_2m_max[todayIndex]  0,n     –î–∞–Ω–Ω—ã–µ –Ω–∞ –∑–∞–≤—Ç—Ä–∞n    rain_tomorrow data.daily.precipitation_sum[tomorrowIndex]  0,n    et0_tomorrow data.daily.et0_fao_evapotranspiration[tomorrowIndex]  0,n    temp_min_tomorrow data.daily.temperature_2m_min[tomorrowIndex]  0,n    temp_max_tomorrow data.daily.temperature_2m_max[tomorrowIndex]  0n  };n  msg.topic = 'openmeteo';n} catch (error) {n  msg.payload = { error '–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ Open-Meteo' };n  msg.topic = 'openmeteo';n}nreturn msg;,
        outputs 1,
        noerr 0,
        x 440,
        y 200,
        wires [
            [
                9c3a25fd97e4ea49
            ]
        ]
    },
    {
        id c1a5a918e5831042,
        type api-current-state,
        z 28cb5adefa62617e,
        name –í–ª–∞–∂–Ω–æ—Å—Ç—å –ø–æ—á–≤—ã,
        server 79fe7aa8.47ef74,
        version 3,
        outputs 1,
        halt_if ,
        halt_if_type str,
        halt_if_compare is,
        entity_id sensor.gw2000a_soil_moisture_1,
        state_type str,
        blockInputOverrides false,
        outputProperties [
            {
                property payload,
                propertyType msg,
                value ,
                valueType entityState
            },
            {
                property data,
                propertyType msg,
                value ,
                valueType entity
            }
        ],
        for 0,
        forType num,
        forUnits minutes,
        x 200,
        y 300,
        wires [
            [
                36c583941cd1ae27
            ]
        ]
    },
    {
        id 36c583941cd1ae27,
        type change,
        z 28cb5adefa62617e,
        name topic soil_moisture,
        rules [
            {
                t set,
                p topic,
                pt msg,
                to soil_moisture,
                tot str
            }
        ],
        x 440,
        y 300,
        wires [
            [
                9c3a25fd97e4ea49
            ]
        ]
    },
    {
        id 2a83d16c0e4e12fd,
        type api-current-state,
        z 28cb5adefa62617e,
        name –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø–æ—á–≤—ã,
        server 79fe7aa8.47ef74,
        version 3,
        outputs 1,
        halt_if_compare is,
        entity_id sensor.gw2000a_soil_temperature_1,
        state_type str,
        blockInputOverrides false,
        outputProperties [
            {
                property payload,
                propertyType msg,
                value ,
                valueType entityState
            },
            {
                property data,
                propertyType msg,
                value ,
                valueType entity
            }
        ],
        for 0,
        forType num,
        forUnits minutes,
        x 200,
        y 380,
        wires [
            [
                5a48d7518005449b
            ]
        ]
    },
    {
        id 5a48d7518005449b,
        type change,
        z 28cb5adefa62617e,
        name topic soil_temp,
        rules [
            {
                t set,
                p topic,
                pt msg,
                to soil_temp,
                tot str
            }
        ],
        x 440,
        y 380,
        wires [
            [
                9c3a25fd97e4ea49
            ]
        ]
    },
    {
        id 9bec688d2806ee9d,
        type api-current-state,
        z 28cb5adefa62617e,
        name –û—Å–∞–¥–∫–∏ –∑–∞ –¥–µ–Ω—å,
        server 79fe7aa8.47ef74,
        version 3,
        outputs 1,
        halt_if_compare is,
        entity_id sensor.ws2350_v2_37_daily_rain_rate,
        state_type str,
        blockInputOverrides false,
        outputProperties [
            {
                property payload,
                propertyType msg,
                value ,
                valueType entityState
            },
            {
                property data,
                propertyType msg,
                value ,
                valueType entity
            }
        ],
        for 0,
        forType num,
        forUnits minutes,
        x 200,
        y 460,
        wires [
            [
                438091c3c6079d3c
            ]
        ]
    },
    {
        id 438091c3c6079d3c,
        type change,
        z 28cb5adefa62617e,
        name topic daily_rain,
        rules [
            {
                t set,
                p topic,
                pt msg,
                to daily_rain,
                tot str
            }
        ],
        x 440,
        y 460,
        wires [
            [
                9c3a25fd97e4ea49
            ]
        ]
    },
    {
        id 634374e67d313901,
        type http request,
        z 28cb5adefa62617e,
        name OpenFarm API,
        method GET,
        ret txt,
        url httpsopenfarm.ccapiv1cropsfilter=lawn,
        x 200,
        y 600,
        wires [
            [
                8ce6a3828ee9aee6
            ]
        ]
    },
    {
        id 8ce6a3828ee9aee6,
        type function,
        z 28cb5adefa62617e,
        name –ü–∞—Ä—Å–∏–Ω–≥ OpenFarm,
        func try {n  const data = JSON.parse(msg.payload);n  msg.topic = 'openfarm';n  n   –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –≥–∞–∑–æ–Ω–∞n  const defaultAdvice = {n    watering '1-2 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é, 10-15 –ª–º¬≤',n    fertilizing 'NPK 20-5-10 –≤–µ—Å–Ω–æ–π –∏ –æ—Å–µ–Ω—å—é',n    mowing '3-5 —Å–º',n    description '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É—Ö–æ–¥—É –∑–∞ –≥–∞–∑–æ–Ω–æ–º'n  };nn  if (data.data && data.data.length  0) {n     –ò—â–µ–º –∑–∞–ø–∏—Å—å –æ –≥–∞–∑–æ–Ω–µn    const lawnData = data.data.find(item = {n      const name = item.attributes.name.toLowerCase();n      const commonNames = item.attributes.common_names  [];n      return name.includes('lawn')  n             commonNames.some(n = n.toLowerCase().includes('lawn')) n             name.includes('–≥–∞–∑–æ–Ω') n             commonNames.some(n = n.toLowerCase().includes('–≥–∞–∑–æ–Ω'));n    });nn    if (lawnData) {n      msg.openfarm = {n        watering lawnData.attributes.watering  defaultAdvice.watering,n        fertilizing lawnData.attributes.fertilizing  defaultAdvice.fertilizing,n        mowing lawnData.attributes.mowing_height  defaultAdvice.mowing,n        description lawnData.attributes.description  defaultAdvice.descriptionn      };n    } else {n      msg.openfarm = defaultAdvice;n    }n  } else {n    msg.openfarm = defaultAdvice;n  }n} catch (e) {n  msg.topic = 'openfarm';n  node.warn('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ OpenFarm ' + e);n   –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏n  msg.openfarm = {n    watering '1-2 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é, 10-15 –ª–º¬≤',n    fertilizing 'NPK 20-5-10 –≤–µ—Å–Ω–æ–π –∏ –æ—Å–µ–Ω—å—é',n    mowing '3-5 —Å–º',n    description '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É—Ö–æ–¥—É –∑–∞ –≥–∞–∑–æ–Ω–æ–º'n  };n}nreturn msg;,
        outputs 1,
        noerr 0,
        x 440,
        y 600,
        wires [
            [
                9c3a25fd97e4ea49
            ]
        ]
    },
    {
        id 3a57fd6cbf8a8fae,
        type api-current-state,
        z 28cb5adefa62617e,
        name –í–ª–∞–∂–Ω–æ—Å—Ç—å –≤–æ–∑–¥—É—Ö–∞,
        server 79fe7aa8.47ef74,
        version 3,
        outputs 1,
        halt_if_compare is,
        entity_id sensor.ws2350_v2_37_humidity,
        state_type str,
        blockInputOverrides false,
        outputProperties [
            {
                property payload,
                propertyType msg,
                value ,
                valueType entityState
            },
            {
                property data,
                propertyType msg,
                value ,
                valueType entity
            }
        ],
        for 0,
        forType num,
        forUnits minutes,
        x 160,
        y 540,
        wires [
            [
                0d13b2f09aef3ac4
            ]
        ]
    },
    {
        id 7d8f824952c4578d,
        type api-current-state,
        z 28cb5adefa62617e,
        name UV –∏–Ω–¥–µ–∫—Å,
        server 79fe7aa8.47ef74,
        version 3,
        outputs 1,
        halt_if_compare is,
        entity_id sensor.ws2350_v2_37_uv_index,
        state_type str,
        blockInputOverrides false,
        outputProperties [
            {
                property payload,
                propertyType msg,
                value ,
                valueType entityState
            }
        ],
        x 150,
        y 660,
        wires [
            [
                da63e164995c4299
            ]
        ]
    },
    {
        id 8f54806c78f9f21b,
        type api-current-state,
        z 28cb5adefa62617e,
        name –¢–æ—á–∫–∞ —Ä–æ—Å—ã,
        server 79fe7aa8.47ef74,
        version 3,
        outputs 1,
        halt_if_compare is,
        entity_id sensor.ws2350_v2_37_dewpoint,
        state_type str,
        blockInputOverrides false,
        outputProperties [
            {
                property payload,
                propertyType msg,
                value ,
                valueType entityState
            }
        ],
        x 150,
        y 760,
        wires [
            [
                fb82dd2d148a26a9
            ]
        ]
    },
    {
        id 920395437ecb30fb,
        type api-current-state,
        z 28cb5adefa62617e,
        name –°–∫–æ—Ä–æ—Å—Ç—å –≤–µ—Ç—Ä–∞,
        server 79fe7aa8.47ef74,
        version 3,
        outputs 1,
        halt_if_compare is,
        entity_id sensor.ws2350_v2_37_wind_speed,
        state_type str,
        blockInputOverrides false,
        outputProperties [
            {
                property payload,
                propertyType msg,
                value ,
                valueType entityState
            }
        ],
        x 150,
        y 820,
        wires [
            [
                d568e2d2cec57b42
            ]
        ]
    },
    {
        id da63e164995c4299,
        type change,
        z 28cb5adefa62617e,
        name topic uv,
        rules [
            {
                t set,
                p topic,
                pt msg,
                to uv,
                tot str
            }
        ],
        x 440,
        y 660,
        wires [
            [
                9c3a25fd97e4ea49
            ]
        ]
    },
    {
        id f3e331678d548323,
        type api-current-state,
        z 28cb5adefa62617e,
        name –°–æ–ª–Ω–µ—á–Ω–∞—è —Ä–∞–¥–∏–∞—Ü–∏—è,
        server 79fe7aa8.47ef74,
        version 3,
        outputs 1,
        halt_if_compare is,
        entity_id sensor.ws2350_v2_37_solar_radiation,
        state_type str,
        blockInputOverrides false,
        outputProperties [
            {
                property payload,
                propertyType msg,
                value ,
                valueType entityState
            }
        ],
        x 160,
        y 700,
        wires [
            [
                6bdbf3c8824d331d
            ]
        ]
    },
    {
        id 6bdbf3c8824d331d,
        type change,
        z 28cb5adefa62617e,
        name topic solar,
        rules [
            {
                t set,
                p topic,
                pt msg,
                to solar,
                tot str
            }
        ],
        x 450,
        y 700,
        wires [
            [
                9c3a25fd97e4ea49
            ]
        ]
    },
    {
        id 0d13b2f09aef3ac4,
        type change,
        z 28cb5adefa62617e,
        name topic humidity,
        rules [
            {
                t set,
                p topic,
                pt msg,
                to humidity,
                tot str
            }
        ],
        x 440,
        y 540,
        wires [
            [
                9c3a25fd97e4ea49
            ]
        ]
    },
    {
        id 9c3a25fd97e4ea49,
        type join,
        z 28cb5adefa62617e,
        name –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö,
        mode custom,
        build object,
        property payload,
        propertyType msg,
        key topic,
        joiner ,
        joinerType str,
        useparts true,
        accumulate false,
        timeout 5,
        count 10,
        reduceRight false,
        reduceExp ,
        reduceInit ,
        reduceInitType ,
        reduceFixup ,
        x 790,
        y 140,
        wires [
            [
                a305977070948b1a,
                9bbb284a5dd9f6a8
            ]
        ]
    },
    {
        id a305977070948b1a,
        type function,
        z 28cb5adefa62617e,
        name –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–æ–≤–µ—Ç–æ–≤,
        func const soilMoisture = msg.payload.soil_moisture  0;nconst soilTemp = msg.payload.soil_temp  0;nconst dailyRain = msg.payload.daily_rain  0;nconst humidity = msg.payload.humidity  0;nconst dewPoint = msg.payload.dew_point  0;nconst windSpeed = msg.payload.wind_speed  0;nconst openmeteo = msg.openmeteo  {n  rain_today 0, rain_tomorrow 0,n  temp_min_today 0, temp_min_tomorrow 0,n  temp_max_today 0, temp_max_tomorrow 0,n  et0_today 0, et0_tomorrow 0n};nconst openfarm = msg.openfarm  {};nnlet advice = [];nn –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∑–∞–º–æ—Ä–æ–∑–∫–∏ –ø–æ –ø—Ä–æ–≥–Ω–æ–∑—É OpenMeteonif (openmeteo.temp_min_today = 0  openmeteo.temp_min_tomorrow = 0) {n  const minTemp = Math.min(openmeteo.temp_min_today, openmeteo.temp_min_tomorrow);n  advice.push(`‚ùÑÔ∏è –í–Ω–∏–º–∞–Ω–∏–µ! –ü—Ä–æ–≥–Ω–æ–∑ –∑–∞–º–æ—Ä–æ–∑–∫–æ–≤! –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤–æ–∑–¥—É—Ö–∞ ${minTemp}¬∞C`);n}nn –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ—á–∫–∏ —Ä–æ—Å—ãnif (dewPoint = 15) {n  advice.push(`‚ö†Ô∏è –¢–æ—á–∫–∞ —Ä–æ—Å—ã –í—ã—Å–æ–∫–∞—è (${dewPoint}¬∞C), —Ä–∏—Å–∫ –≥—Ä–∏–±–∫–æ–≤—ã—Ö –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π`);n  if (humidity  80) {n    advice.push('‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –û—Ç–ª–æ–∂–∏—Ç–µ —Å—Ç—Ä–∏–∂–∫—É –¥–æ —Å–Ω–∏–∂–µ–Ω–∏—è –≤–ª–∞–∂–Ω–æ—Å—Ç–∏');n  }n  if (soilMoisture  50) {n    advice.push('‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥—Ä–µ–Ω–∞–∂, –≤–æ–∑–º–æ–∂–Ω–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∞—ç—Ä–∞—Ü–∏—è');n  }n} else if (dewPoint = 10) {n  advice.push(`‚ÑπÔ∏è –¢–æ—á–∫–∞ —Ä–æ—Å—ã –£–º–µ—Ä–µ–Ω–Ω–∞—è (${dewPoint}¬∞C), —Å–ª–µ–¥–∏—Ç–µ –∑–∞ –≤–ª–∞–∂–Ω–æ—Å—Ç—å—é`);n}nn –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤–µ—Ç—Ä–∞nif (windSpeed = 15) {n  advice.push(`‚ö†Ô∏è –í–µ—Ç–µ—Ä –°–∏–ª—å–Ω—ã–π (${windSpeed} –∫–º—á), –ø–æ–ª–∏–≤ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è`);n  if (dewPoint = 15) {n    advice.push('‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ü—Ä–∏ —Å–∏–ª—å–Ω–æ–º –≤–µ—Ç—Ä–µ –∏ –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–∫–µ —Ä–æ—Å—ã —Ä–∏—Å–∫ –≥—Ä–∏–±–∫–æ–≤—ã—Ö –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –ø–æ–≤—ã—à–µ–Ω');n  }n} else if (windSpeed  5) {n  advice.push(`‚ÑπÔ∏è –í–µ—Ç–µ—Ä –£–º–µ—Ä–µ–Ω–Ω—ã–π (${windSpeed} –∫–º—á), –ø–æ–ª–∏–≤ –≤–æ–∑–º–æ–∂–µ–Ω`);n  if (dewPoint = 15) {n    advice.push('‚ÑπÔ∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ü—Ä–∏ —É–º–µ—Ä–µ–Ω–Ω–æ–º –≤–µ—Ç—Ä–µ –∏ –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–∫–µ —Ä–æ—Å—ã –ø–æ–ª–∏–≤ –ª—É—á—à–µ –æ—Ç–ª–æ–∂–∏—Ç—å');n  }n}nn –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥—Ä–µ–Ω–∞–∂—É –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Å–∞–¥–∫–æ–≤ –∏ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏ –ø–æ—á–≤—ã (–ø–æ –¥–∞—Ç—á–∏–∫–∞–º)nconst isWarmEnough = openmeteo.temp_min_today  0 && openmeteo.temp_min_tomorrow  0;nif (isWarmEnough && (soilMoisture  50  dailyRain  5  dewPoint = 15)) {n    let drainageReasons = [];n    if (soilMoisture  50) {n        drainageReasons.push(`–≤—ã—Å–æ–∫–∞—è –≤–ª–∞–∂–Ω–æ—Å—Ç—å –ø–æ—á–≤—ã (${soilMoisture}%)`);n    }n    if (dailyRain  5) {n        drainageReasons.push(`–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Å–∞–¥–∫–∏ –∑–∞ –¥–µ–Ω—å (${dailyRain} –º–º)`);n    }n    if (dewPoint = 15) {n        drainageReasons.push(`–≤—ã—Å–æ–∫–∞—è —Ç–æ—á–∫–∞ —Ä–æ—Å—ã (${dewPoint}¬∞C)`);n    }n    advice.push(`‚ö†Ô∏è –î—Ä–µ–Ω–∞–∂ –¢—Ä–µ–±—É–µ—Ç—Å—è. –ü—Ä–∏—á–∏–Ω—ã ${drainageReasons.join('; ')}`);n}nelse if (!isWarmEnough) {n    advice.push('‚ö†Ô∏è –î—Ä–µ–Ω–∞–∂ –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏–∑-–∑–∞ —Ä–∏—Å–∫–∞ –∑–∞–º–æ—Ä–æ–∑–∫–æ–≤');n}nn –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø–æ–ª–∏–≤—É —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤n –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —É—Å–ª–æ–≤–∏—è –ø–æ –ø–æ—Ä—è–¥–∫—Énlet wateringAdvice = null;nn 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏ –ø–æ—á–≤—ã (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ —É—Å–ª–æ–≤–∏–µ)nif (soilMoisture = 40) {n    wateringAdvice = 'üíß –ü–æ–ª–∏–≤ –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è, –≤–ª–∞–∂–Ω–æ—Å—Ç—å –ø–æ—á–≤—ã –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è';n}n 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å–∞–¥–∫–æ–≤ (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ —É—Å–ª–æ–≤–∏–µ)nelse if (openmeteo.rain_today = 5  openmeteo.rain_tomorrow = 5) {n    const rainDays = [];n    if (openmeteo.rain_today = 5) rainDays.push('—Å–µ–≥–æ–¥–Ω—è');n    if (openmeteo.rain_tomorrow = 5) rainDays.push('–∑–∞–≤—Ç—Ä–∞');n    wateringAdvice = `üíß –ü–æ–ª–∏–≤ –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è, –æ–∂–∏–¥–∞—é—Ç—Å—è –æ—Å–∞–¥–∫–∏ ${rainDays.join(' –∏ ')}`;n}n 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤–µ—Ç—Ä–∞ (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ —É—Å–ª–æ–≤–∏–µ)nelse if (windSpeed = 15) {n    wateringAdvice = 'üíß –ü–æ–ª–∏–≤ –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏–∑-–∑–∞ —Å–∏–ª—å–Ω–æ–≥–æ –≤–µ—Ç—Ä–∞';n}n 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ—á–∫–∏ —Ä–æ—Å—ã (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ —É—Å–ª–æ–≤–∏–µ)nelse if (dewPoint = 15) {n    wateringAdvice = 'üíß –ü–æ–ª–∏–≤ –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏–∑-–∑–∞ –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–∫–∏ —Ä–æ—Å—ã';n}n 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–∞—Ä—è–µ–º–æ—Å—Ç–∏ (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ —É—Å–ª–æ–≤–∏–µ)nelse if (openmeteo.et0_today = 3) {n    wateringAdvice = 'üíß –ü–æ–ª–∏–≤ –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è, –Ω–∏–∑–∫–∞—è –∏—Å–ø–∞—Ä—è–µ–º–æ—Å—Ç—å';n}n –ï—Å–ª–∏ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —É—Å–ª–æ–≤–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã, –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—ènelse {n    wateringAdvice = 'üíß –ü–æ–ª–∏–≤ 10-15 –ª–º¬≤ –¥–æ 10 —É—Ç—Ä–∞';n}nnadvice.push(wateringAdvice);nn –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–¥–æ–±—Ä–µ–Ω–∏—è–ºnlet fertilizingAdvice = null;nn 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –ø–æ—á–≤—ã (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ —É—Å–ª–æ–≤–∏–µ)nif (soilTemp = 5) {n    fertilizingAdvice = 'üå± –£–¥–æ–±—Ä–µ–Ω–∏—è –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø–æ—á–≤—ã —Å–ª–∏—à–∫–æ–º –Ω–∏–∑–∫–∞—è';n}n 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å–∞–¥–∫–æ–≤ (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ —É—Å–ª–æ–≤–∏–µ)nelse if (openmeteo.rain_today = 1  openmeteo.rain_tomorrow = 1) {n    fertilizingAdvice = 'üå± –£–¥–æ–±—Ä–µ–Ω–∏—è –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è, –æ–∂–∏–¥–∞—é—Ç—Å—è –æ—Å–∞–¥–∫–∏';n}n –ï—Å–ª–∏ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —É—Å–ª–æ–≤–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ãnelse {n    fertilizingAdvice = 'üå± –£–¥–æ–±—Ä–µ–Ω–∏—è –í–Ω–µ—Å–∏—Ç–µ NPK 20-5-10 (30 –≥–º¬≤)';n}nnadvice.push(fertilizingAdvice);nn –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Å—Ç—Ä–∏–∂–∫–µnlet mowingAdvice = null;nn 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –ø–æ—á–≤—ã (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ —É—Å–ª–æ–≤–∏–µ)nif (soilTemp = 5) {n    mowingAdvice = '‚úÇÔ∏è –°—Ç—Ä–∏–∂–∫–∞ –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø–æ—á–≤—ã —Å–ª–∏—à–∫–æ–º –Ω–∏–∑–∫–∞—è';n}n 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏ –≤–æ–∑–¥—É—Ö–∞ (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ —É—Å–ª–æ–≤–∏–µ)nelse if (humidity = 80) {n    mowingAdvice = '‚úÇÔ∏è –°—Ç—Ä–∏–∂–∫–∞ –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è, –≤—ã—Å–æ–∫–∞—è –≤–ª–∞–∂–Ω–æ—Å—Ç—å –≤–æ–∑–¥—É—Ö–∞';n}n 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ—á–∫–∏ —Ä–æ—Å—ã (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ —É—Å–ª–æ–≤–∏–µ)nelse if (dewPoint = 15) {n    mowingAdvice = '‚úÇÔ∏è –°—Ç—Ä–∏–∂–∫–∞ –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è, –≤—ã—Å–æ–∫–∞—è —Ç–æ—á–∫–∞ —Ä–æ—Å—ã';n}n 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤–µ—Ç—Ä–∞ (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ —É—Å–ª–æ–≤–∏–µ)nelse if (windSpeed = 15) {n    mowingAdvice = '‚úÇÔ∏è –°—Ç—Ä–∏–∂–∫–∞ –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è, —Å–∏–ª—å–Ω—ã–π –≤–µ—Ç–µ—Ä';n}n –ï—Å–ª–∏ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —É—Å–ª–æ–≤–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ãnelse {n    mowingAdvice = `‚úÇÔ∏è –°—Ç—Ä–∏–∂–∫–∞ ${openfarm.mowing  '3-5 —Å–º'}`;n}nnadvice.push(mowingAdvice);nnmsg.payload = { advice advice.join('n')  '–°–µ–≥–æ–¥–Ω—è –æ—Å–æ–±—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.' };nreturn msg;,
        outputs 1,
        noerr 0,
        x 1060,
        y 140,
        wires [
            [
                5ab8cce0d9e166e4
            ]
        ]
    },
    {
        id 5ab8cce0d9e166e4,
        type function,
        z 28cb5adefa62617e,
        name –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ,
        func const today = new Date().toLocaleDateString('ru-RU', { day 'numeric', month 'long' });nconst text = `üåø –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ ${today}n${msg.payload.advice}`;nmsg.payload = {n  chatId '-1001548038296',n  type 'message',n  content text,n  parse_mode 'Markdown'n};nreturn msg;,
        outputs 1,
        noerr 0,
        x 1070,
        y 220,
        wires [
            [
                609dab23043476c2,
                8f1f2b4bd9507694
            ]
        ]
    },
    {
        id 9ce3ebb47e1ab617,
        type telegram sender,
        z 28cb5adefa62617e,
        name Telegram,
        bot df690a6504c1e710,
        haserroroutput false,
        outputs 1,
        x 1060,
        y 280,
        wires [
            []
        ]
    },
    {
        id 609dab23043476c2,
        type debug,
        z 28cb5adefa62617e,
        name debug 3,
        active true,
        tosidebar true,
        console false,
        tostatus false,
        complete false,
        statusVal ,
        statusType auto,
        x 1440,
        y 680,
        wires []
    },
    {
        id 9bbb284a5dd9f6a8,
        type function,
        z 28cb5adefa62617e,
        name –ü—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏—è –æ –ø–æ–ª–∏–≤–µ,
        func const soilMoisture = parseFloat(msg.payload.soil_moisture)  0;nconst humidity = parseFloat(msg.payload.humidity)  0;nconst dailyRain = parseFloat(msg.payload.daily_rain)  0;nconst uv = parseFloat(msg.payload.uv)  0;nconst solar = parseFloat(msg.payload.solar)  0;nconst dewPoint = parseFloat(msg.payload.dew_point)  0;nconst windSpeed = parseFloat(msg.payload.wind_speed)  0;nconst openmeteo = msg.openmeteo  { n  rain_today 0, rain_tomorrow 0,n  et0_today 0, et0_tomorrow 0,n  temp_min_today 0, temp_min_tomorrow 0n};nn –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –ø–æ–ª–∏–≤–∞ (–Ω–µ —Ä–∞–Ω—å—à–µ 600)nconst now = new Date();nconst currentHour = now.getHours();nconst currentMinute = now.getMinutes();nn –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –ø–æ–ª–∏–≤–∞nconst isSafeTime = currentHour = 6 && currentHour  8;  –ü–æ–ª–∏–≤ —Ç–æ–ª—å–∫–æ —Å 600 –¥–æ 800nconst isSafeUV = uv  2;  UV –∏–Ω–¥–µ–∫—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–µ–Ω—å—à–µ 2nconst isSafeSolar = solar  100;  –°–æ–ª–Ω–µ—á–Ω–∞—è —Ä–∞–¥–∏–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –º–µ–Ω—å—à–µ 100 –í—Ç–º¬≤nconst isDewPointSafe = dewPoint  15;  –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ç–æ—á–∫–∞ —Ä–æ—Å—ã –¥–ª—è –≥–∞–∑–æ–Ω–∞nconst isWindSafe = windSpeed  15;  –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –≤–µ—Ç—Ä–∞ –¥–ª—è –ø–æ–ª–∏–≤–∞ (–∫–º—á)nn –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å–ª–æ–≤–∏—è –¥–ª—è –¥—Ä–µ–Ω–∞–∂–∞nconst isWarmEnough = openmeteo.temp_min_today  0 && openmeteo.temp_min_tomorrow  0;  –Ω–µ—Ç –∑–∞–º–æ—Ä–æ–∑–∫–æ–≤nconst needsDrainage = isWarmEnough && (  —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤—ã—à–µ –Ω—É–ª—è –òn    soilMoisture  50   –≤—ã—Å–æ–∫–∞—è –≤–ª–∞–∂–Ω–æ—Å—Ç—å –ø–æ—á–≤—ã –ò–õ–òn    dailyRain  5   –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Å–∞–¥–∫–∏ –∑–∞ –¥–µ–Ω—å –ò–õ–òn    dewPoint = 15  –≤—ã—Å–æ–∫–∞—è —Ç–æ—á–∫–∞ —Ä–æ—Å—ãn);nn –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø–æ–ª–∏–≤–∞ —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö —É—Å–ª–æ–≤–∏–πnconst needsWatering = soilMoisture  40 &&  –Ω–∏–∑–∫–∞—è –≤–ª–∞–∂–Ω–æ—Å—Ç—å –ø–æ—á–≤—ãn                     humidity  70 &&  –Ω–∏–∑–∫–∞—è –≤–ª–∞–∂–Ω–æ—Å—Ç—å –≤–æ–∑–¥—É—Ö–∞n                     openmeteo.et0_today  3 &&  –≤—ã—Å–æ–∫–∞—è –∏—Å–ø–∞—Ä—è–µ–º–æ—Å—Ç—ån                     openmeteo.rain_today  5 &&  –Ω–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö –æ—Å–∞–¥–∫–æ–≤ —Å–µ–≥–æ–¥–Ω—èn                     openmeteo.rain_tomorrow  5 &&  –Ω–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö –æ—Å–∞–¥–∫–æ–≤ –∑–∞–≤—Ç—Ä–∞n                     isSafeTime &&  –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—Ä–µ–º—èn                     isSafeUV &&  –±–µ–∑–æ–ø–∞—Å–Ω—ã–π UV –∏–Ω–¥–µ–∫—Ån                     isSafeSolar &&  –±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–æ–ª–Ω–µ—á–Ω–∞—è —Ä–∞–¥–∏–∞—Ü–∏—èn                     isDewPointSafe &&  –±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ç–æ—á–∫–∞ —Ä–æ—Å—ãn                     isWindSafe;  –±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –≤–µ—Ç—Ä–∞nn –†–∞—Å—á–µ—Ç –æ–±—ä–µ–º–∞ –≤–æ–¥—ã –¥–ª—è –ø–æ–ª–∏–≤–∞ (–ª–º¬≤)nlet wateringAmount = 0;nif (needsWatering) {n     –ë–∞–∑–æ–≤—ã–π –æ–±—ä–µ–º 10-15 –ª–º¬≤ —Å –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–æ–π –Ω–∞ –∏—Å–ø–∞—Ä—è–µ–º–æ—Å—Ç—ån    wateringAmount = 10 + Math.min(5, openmeteo.et0_today - 3);n    n     –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –≤–ª–∞–∂–Ω–æ—Å—Ç—å –ø–æ—á–≤—ãn    if (soilMoisture  30) {n        wateringAmount += 2;  –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –ø—Ä–∏ –æ—á–µ–Ω—å —Å—É—Ö–æ–π –ø–æ—á–≤–µn    } else if (soilMoisture  35) {n        wateringAmount -= 2;  –£–º–µ–Ω—å—à–∞–µ–º –ø—Ä–∏ –ø–æ—á–≤–µ –±–ª–∏–∂–µ –∫ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–πn    }n    n     –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å –≤–µ—Ç—Ä–∞n    if (windSpeed  5) {n        wateringAmount += Math.min(2, windSpeed  5);  –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –ø—Ä–∏ –≤–µ—Ç—Ä–µn    }n    n     –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ —Ç–æ—á–∫—É —Ä–æ—Å—ãn    if (dewPoint  10) {n        wateringAmount -= Math.min(2, (dewPoint - 10)  2);  –£–º–µ–Ω—å—à–∞–µ–º –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–∫–µ —Ä–æ—Å—ãn    }n    n     –£—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–æ–≥–Ω–æ–∑ –æ—Å–∞–¥–∫–æ–≤ –Ω–∞ —Å–µ–≥–æ–¥–Ω—èn    if (openmeteo.rain_today  0 && openmeteo.rain_today  5) {n        wateringAmount -= openmeteo.rain_today;  –£–º–µ–Ω—å—à–∞–µ–º –Ω–∞ –æ–±—ä–µ–º –æ–∂–∏–¥–∞–µ–º—ã—Ö –æ—Å–∞–¥–∫–æ–≤n    }n    n     –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µn    wateringAmount = Math.max(8, Math.min(17, wateringAmount));n}nn –û–±—â–∏–π –æ–±—ä–µ–º –¥–ª—è –≤—Å–µ–π –ø–ª–æ—â–∞–¥–∏ (300 –∫–≤.–º)nconst totalWateringAmount = wateringAmount  300;nn –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ü–µ–ª–µ–≤–æ–π –æ–±—ä–µ–º –≤–æ–¥—ã –∏ –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –ø–æ–ª–∏–≤–∞nglobal.set('watering_target_volume', totalWateringAmount);nglobal.set('watering_start_time', new Date().getTime());nn –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–∏—á–∏–Ω–∞—Ö –æ—Ç–∫–∞–∑–∞ –æ—Ç –ø–æ–ª–∏–≤–∞nconst reasons = [];nif (!isSafeTime) {n    reasons.push(`–í—Ä–µ–º—è –ø–æ–ª–∏–≤–∞ –Ω–µ –ø–æ–¥—Ö–æ–¥—è—â–µ–µ (${currentHour}${currentMinute})`);n}nif (!isSafeUV) {n    reasons.push(`UV –∏–Ω–¥–µ–∫—Å —Å–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∏–π (${uv})`);n}nif (!isSafeSolar) {n    reasons.push(`–°–æ–ª–Ω–µ—á–Ω–∞—è —Ä–∞–¥–∏–∞—Ü–∏—è —Å–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∞—è (${solar} –í—Ç–º¬≤)`);n}nif (!isDewPointSafe) {n    reasons.push(`–¢–æ—á–∫–∞ —Ä–æ—Å—ã —Å–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∞—è (${dewPoint}¬∞C)`);n}nif (!isWindSafe) {n    reasons.push(`–°–∫–æ—Ä–æ—Å—Ç—å –≤–µ—Ç—Ä–∞ —Å–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∞—è (${windSpeed} –∫–º—á)`);n}nnmsg.payload = { n    needsWatering needsWatering, n    needsDrainage needsDrainage, n    wateringAmountPerSqm wateringAmount, n    totalWateringAmount totalWateringAmount, n    area 300, n    soilMoisture soilMoisture, n    humidity humidity, n    dailyRain dailyRain, n    et0Today openmeteo.et0_today, n    rainToday openmeteo.rain_today, n    rainTomorrow openmeteo.rain_tomorrow, n    uv uv, n    solar solar,n    dewPoint dewPoint,n    windSpeed windSpeed,n    currentTime `${currentHour}${currentMinute}`, n    safetyReasons reasons n};nnreturn msg;,
        outputs 1,
        noerr 0,
        x 830,
        y 320,
        wires [
            [
                d7bcd7a32efa729a
            ]
        ]
    },
    {
        id d7bcd7a32efa729a,
        type switch,
        z 28cb5adefa62617e,
        name –†–µ—à–µ–Ω–∏–µ –æ –ø–æ–ª–∏–≤–µ–¥—Ä–µ–Ω–∞–∂–µ,
        property payload.needsDrainage,
        propertyType msg,
        rules [
            {
                t true
            },
            {
                t true,
                v payload.needsWatering,
                vt msg
            },
            {
                t else
            }
        ],
        checkall false,
        outputs 3,
        x 780,
        y 440,
        wires [
            [
                3bafaa9d880c9361
            ],
            [
                176dc737c8f912b9
            ],
            [
                9e76918b2906600a
            ]
        ]
    },
    {
        id 3bafaa9d880c9361,
        type function,
        z 28cb5adefa62617e,
        name –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥—Ä–µ–Ω–∞–∂–∞,
        func const reasons = [];nn –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—Ä–∏—á–∏–Ω—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥—Ä–µ–Ω–∞–∂–∞nif (msg.payload.soilMoisture  50) {n    reasons.push(`–≤—ã—Å–æ–∫–∞—è –≤–ª–∞–∂–Ω–æ—Å—Ç—å –ø–æ—á–≤—ã (${msg.payload.soilMoisture}%)`);n}nnif (msg.payload.dailyRain  5) {n    reasons.push(`–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Å–∞–¥–∫–∏ –∑–∞ –¥–µ–Ω—å (${msg.payload.dailyRain} –º–º)`);n}nn –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞—Ç—Énconst now = new Date();nconst formattedDate = now.toLocaleDateString('ru-RU');nnmsg.payload = {n    content `üíß –¢—Ä–µ–±—É–µ—Ç—Å—è –¥—Ä–µ–Ω–∞–∂ ${formattedDate}n` +n             `–ü—Ä–∏—á–∏–Ω—ã ${reasons.join('; ')}`n};nnnode.status({fillyellow, shapering, text–¢—Ä–µ–±—É–µ—Ç—Å—è –¥—Ä–µ–Ω–∞–∂});nnreturn msg;,
        outputs 1,
        noerr 0,
        x 740,
        y 760,
        wires [
            [
                609dab23043476c2
            ]
        ]
    },
    {
        id 176dc737c8f912b9,
        type api-call-service,
        z 28cb5adefa62617e,
        name –ó–∞–ø—É—Å–∫ –ø–æ–ª–∏–≤–∞,
        server 79fe7aa8.47ef74,
        version 7,
        debugenabled false,
        action rest_command.wfc01_watering_start,
        floorId [],
        areaId [],
        deviceId [],
        entityId [],
        labelId [],
        data ,
        dataType json,
        mergeContext ,
        mustacheAltTags false,
        outputProperties [],
        queue none,
        blockInputOverrides false,
        domain rest_command,
        service wfc01_watering_start,
        x 1140,
        y 340,
        wires [
            [
                c1d7b9911e8722d9
            ]
        ]
    },
    {
        id c1d7b9911e8722d9,
        type api-current-state,
        z 28cb5adefa62617e,
        name –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞—Å—Ö–æ–¥–∞ –≤–æ–¥—ã,
        server 79fe7aa8.47ef74,
        version 3,
        outputs 1,
        halt_if ,
        halt_if_type str,
        halt_if_compare is,
        entity_id sensor.wfc01_water_total,
        state_type str,
        blockInputOverrides false,
        outputProperties [
            {
                property payload,
                propertyType msg,
                value ,
                valueType entityState
            }
        ],
        x 1140,
        y 440,
        wires [
            [
                925b4e12122d2d68
            ]
        ]
    },
    {
        id 925b4e12122d2d68,
        type function,
        z 28cb5adefa62617e,
        name –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—ä–µ–º–∞ –≤–æ–¥—ã,
        func  –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π –æ–±—ä–µ–º –≤–æ–¥—ã –∏–∑ –¥–∞—Ç—á–∏–∫–∞nconst currentVolume = parseFloat(msg.payload)  0;nn –ü–æ–ª—É—á–∞–µ–º —Ü–µ–ª–µ–≤–æ–π –æ–±—ä–µ–º –∏ –Ω–∞—á–∞–ª—å–Ω—ã–π –æ–±—ä–µ–ºnconst targetVolume = global.get('watering_target_volume')  0;nlet startVolume = global.get('watering_start_volume');nlet startTime = global.get('watering_start_time');nn –ï—Å–ª–∏ –Ω–∞—á–∞–ª—å–Ω—ã–π –æ–±—ä–µ–º –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –µ–≥–æ —Å–µ–π—á–∞—Ånif (startVolume === undefined  startVolume === null) {n    startVolume = currentVolume;n    startTime = new Date().getTime();n    global.set('watering_start_volume', startVolume);n    global.set('watering_start_time', startTime);n    node.status({fillblue, shapedot, text–ù–∞—á–∞–ª–æ –ø–æ–ª–∏–≤–∞});n}nn –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –≤—ã–¥–∞–Ω–Ω—ã–π –æ–±—ä–µ–º –≤–æ–¥—ãnconst deliveredVolume = currentVolume - startVolume;nn –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –æ—à–∏–±–∫–∏nif (deliveredVolume  0) {n    node.error(–û—à–∏–±–∫–∞ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –æ–±—ä–µ–º –≤–æ–¥—ã);n    return [null, null];n}nn –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Ä–µ–º—è –ø–æ–ª–∏–≤–∞ (–º–∞–∫—Å–∏–º—É–º 2 —á–∞—Å–∞)nconst now = new Date().getTime();nconst wateringDuration = (now - startTime)  60000;  –≤ –º–∏–Ω—É—Ç–∞—Önconst maxDuration = 120;  2 —á–∞—Å–∞ –≤ –º–∏–Ω—É—Ç–∞—Önn –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å–ª–æ–≤–∏—è –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ–ª–∏–≤–∞nconst targetReached = deliveredVolume = targetVolume;nconst timeExceeded = wateringDuration = maxDuration;nn –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–ª–∏–≤–∞ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Önconst progressPercent = targetVolume  0  Math.min(100, (deliveredVolume  targetVolume)  100)  0;nn –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—ènglobal.set('watering_progress', progressPercent.toFixed(0));nglobal.set('watering_delivered', deliveredVolume.toFixed(0));nn –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –Ω–æ–¥—ã —Å –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–πnnode.status({n    fill blue,n    shape dot,n    text `–ü—Ä–æ–≥—Ä–µ—Å—Å ${progressPercent.toFixed(0)}%, ${deliveredVolume.toFixed(0)}–ª –∏–∑ ${targetVolume.toFixed(0)}–ª, ${Math.round(wateringDuration)} –º–∏–Ω`n});nn –ï—Å–ª–∏ –¥–æ—Å—Ç–∏–≥–ª–∏ —Ü–µ–ª–µ–≤–æ–≥–æ –æ–±—ä–µ–º–∞ –∏–ª–∏ –ø—Ä–µ–≤—ã—Å–∏–ª–∏ –≤—Ä–µ–º—è, –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–æ–ª–∏–≤nif (targetReached  timeExceeded) {n    msg.targetReached = targetReached;n    msg.timeExceeded = timeExceeded;n    msg.deliveredVolume = deliveredVolume;n    msg.progressPercent = progressPercent;n    msg.wateringDuration = Math.round(wateringDuration);n    return [msg, null];n} else {n     –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥n    msg.targetReached = false;n    msg.timeExceeded = false;n    msg.deliveredVolume = deliveredVolume;n    msg.progressPercent = progressPercent;n    msg.wateringDuration = Math.round(wateringDuration);n    return [null, msg];n},
        outputs 2,
        noerr 0,
        x 1410,
        y 440,
        wires [
            [
                2ffbf24ccce63666
            ],
            [
                c4ab7144b09d650f
            ]
        ]
    },
    {
        id c4ab7144b09d650f,
        type delay,
        z 28cb5adefa62617e,
        name –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫,
        pauseType delay,
        timeout 30,
        timeoutUnits seconds,
        rate 1,
        nbRateUnits 1,
        rateUnits second,
        randomFirst 1,
        randomLast 5,
        randomUnits seconds,
        drop false,
        allowrate false,
        outputs 1,
        x 1250,
        y 540,
        wires [
            [
                c1d7b9911e8722d9
            ]
        ]
    },
    {
        id 2ffbf24ccce63666,
        type api-call-service,
        z 28cb5adefa62617e,
        name –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–ª–∏–≤–∞,
        server 79fe7aa8.47ef74,
        version 7,
        debugenabled false,
        action rest_command.wfc01_watering_stop,
        floorId [],
        areaId [],
        deviceId [],
        entityId [],
        labelId [],
        data ,
        dataType json,
        mergeContext ,
        mustacheAltTags false,
        outputProperties [],
        queue none,
        blockInputOverrides false,
        domain rest_command,
        service wfc01_watering_stop,
        x 1410,
        y 340,
        wires [
            [
                777c92c0ad908c7e
            ]
        ]
    },
    {
        id 777c92c0ad908c7e,
        type function,
        z 28cb5adefa62617e,
        name –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ–ª–∏–≤–∞,
        func  –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª–∏–≤–µnconst startTime = global.get('watering_start_time');nconst deliveredVolume = msg.deliveredVolume  0;nconst targetVolume = global.get('watering_target_volume')  0;nconst wateringDuration = msg.wateringDuration  0;nn –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—Ä–∏—á–∏–Ω—É –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ–ª–∏–≤–∞nlet stopReason = '';nif (msg.targetReached) {n    stopReason = '–¥–æ—Å—Ç–∏–≥–Ω—É—Ç —Ü–µ–ª–µ–≤–æ–π –æ–±—ä–µ–º –≤–æ–¥—ã';n} else if (msg.timeExceeded) {n    stopReason = '–ø—Ä–µ–≤—ã—à–µ–Ω–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –ø–æ–ª–∏–≤–∞ (2 —á–∞—Å–∞)';n} else {n    stopReason = '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞';n}nn –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞—Ç—É –∏ –≤—Ä–µ–º—ènconst now = new Date();nconst formattedDate = now.toLocaleDateString('ru-RU');nconst formattedTime = now.toLocaleTimeString('ru-RU');nn –ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç —Ü–µ–ª–µ–≤–æ–≥–æ –æ–±—ä–µ–º–∞nconst percentDelivered = targetVolume  0  (deliveredVolume  targetVolume)  100  100;nnmsg.payload = {n    content `‚úÖ –ü–æ–ª–∏–≤ –∑–∞–≤–µ—Ä—à–µ–Ω ${formattedDate} –≤ ${formattedTime}n` +n             `–ü—Ä–∏—á–∏–Ω–∞ ${stopReason}n` +n             `–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å ${wateringDuration} –º–∏–Ωn` +n             `–í—ã–¥–∞–Ω–æ –≤–æ–¥—ã ${deliveredVolume.toFixed(0)} –ª (${percentDelivered.toFixed(0)}% –æ—Ç –ø–ª–∞–Ω–∞)n` +n             `–†–∞—Å—Ö–æ–¥ ${(deliveredVolume  300).toFixed(1)} –ª–º¬≤`n};nn –û—á–∏—â–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—ènglobal.set('watering_start_time', null);nglobal.set('watering_target_volume', null);nglobal.set('watering_start_volume', null);nglobal.set('watering_progress', null);nglobal.set('watering_delivered', null);nnnode.status({fillgreen, shapering, text–ü–æ–ª–∏–≤ –∑–∞–≤–µ—Ä—à–µ–Ω});nnreturn msg;,
        outputs 1,
        noerr 0,
        x 1420,
        y 240,
        wires [
            [
                609dab23043476c2
            ]
        ]
    },
    {
        id 9e76918b2906600a,
        type function,
        z 28cb5adefa62617e,
        name –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–∫–∞–∑–∞ –æ—Ç –ø–æ–ª–∏–≤–∞,
        func const reasons = [];nn –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—Ä–∏—á–∏–Ω—ã –æ—Ç–∫–∞–∑–∞ –æ—Ç –ø–æ–ª–∏–≤–∞nif (msg.payload.soilMoisture = 40) {n    reasons.push(`–í–ª–∞–∂–Ω–æ—Å—Ç—å –ø–æ—á–≤—ã –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è (${msg.payload.soilMoisture}%)`);n}nnif (msg.payload.rainToday = 5) {n    reasons.push(`–û–∂–∏–¥–∞—é—Ç—Å—è –æ—Å–∞–¥–∫–∏ —Å–µ–≥–æ–¥–Ω—è (${msg.payload.rainToday} –º–º)`);n}nnif (msg.payload.rainTomorrow = 5) {n    reasons.push(`–û–∂–∏–¥–∞—é—Ç—Å—è –æ—Å–∞–¥–∫–∏ –∑–∞–≤—Ç—Ä–∞ (${msg.payload.rainTomorrow} –º–º)`);n}nnif (msg.payload.et0Today = 3) {n    reasons.push(`–ù–∏–∑–∫–∞—è –∏—Å–ø–∞—Ä—è–µ–º–æ—Å—Ç—å (ET0 ${msg.payload.et0Today})`);n}nn –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–∏—á–∏–Ω—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—énif (msg.payload.safetyReasons && msg.payload.safetyReasons.length  0) {n    reasons.push(...msg.payload.safetyReasons);n}nn –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞—Ç—Énconst now = new Date();nconst formattedDate = now.toLocaleDateString('ru-RU');nnmsg.payload = {n    content `‚ÑπÔ∏è –ü–æ–ª–∏–≤ ${formattedDate} –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—èn` +n             `–ü—Ä–∏—á–∏–Ω—ã ${reasons.join('; ')}`n};nnnode.status({fillblue, shapering, text–ü–æ–ª–∏–≤ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è});nnreturn msg;,
        outputs 1,
        noerr 0,
        x 910,
        y 700,
        wires [
            [
                609dab23043476c2
            ]
        ]
    },
    {
        id 7b4b182f39d6fd5a,
        type catch,
        z 28cb5adefa62617e,
        name ,
        scope null,
        uncaught false,
        x 950,
        y 600,
        wires [
            [
                609dab23043476c2
            ]
        ]
    },
    {
        id fb82dd2d148a26a9,
        type change,
        z 28cb5adefa62617e,
        name topic dew_point,
        rules [
            {
                t set,
                p topic,
                pt msg,
                to dew_point,
                tot str
            }
        ],
        x 440,
        y 740,
        wires [
            [
                9c3a25fd97e4ea49
            ]
        ]
    },
    {
        id d568e2d2cec57b42,
        type change,
        z 28cb5adefa62617e,
        name topic wind_speed,
        rules [
            {
                t set,
                p topic,
                pt msg,
                to wind_speed,
                tot str
            }
        ],
        x 440,
        y 820,
        wires [
            [
                9c3a25fd97e4ea49
            ]
        ]
    },
    {
        id 8f1f2b4bd9507694,
        type delay,
        z 28cb5adefa62617e,
        name ,
        pauseType delay,
        timeout 2,
        timeoutUnits hours,
        rate 1,
        nbRateUnits 1,
        rateUnits second,
        randomFirst 1,
        randomLast 5,
        randomUnits seconds,
        drop false,
        allowrate false,
        outputs 1,
        x 870,
        y 280,
        wires [
            [
                9ce3ebb47e1ab617
            ]
        ]
    },
    {
        id 79fe7aa8.47ef74,
        type server,
        name Home Assistant,
        addon true,
        rejectUnauthorizedCerts true,
        ha_boolean ,
        connectionDelay false,
        cacheJson false,
        heartbeat false,
        heartbeatInterval ,
        statusSeparator ,
        enableGlobalContextStore false
    },
    {
        id df690a6504c1e710,
        type telegram bot,
        botname KPMG_TG_Bot,
        usernames ,
        chatids 2093488216, -1001548038296,
        baseapiurl ,
        testenvironment false,
        updatemode polling,
        pollinterval 2500,
        usesocks false,
        sockshost ,
        socksprotocol socks5,
        socksport 6667,
        socksusername anonymous,
        sockspassword ,
        bothost ,
        botpath ,
        localbothost ,
        localbotport 8443,
        publicbotport 8443,
        privatekey ,
        certificate ,
        useselfsignedcertificate false,
        sslterminated false,
        verboselogging false
    }
]